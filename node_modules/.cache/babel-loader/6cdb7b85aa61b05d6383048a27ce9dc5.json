{"ast":null,"code":"import \"core-js/modules/es.string.replace\";\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport PlaygroundError from 'rsg-components/PlaygroundError';\nimport ReactExample from 'rsg-components/ReactExample';\nimport Context from 'rsg-components/Context';\n\nvar improveErrorMessage = function improveErrorMessage(message) {\n  return message.replace('Check the render method of `StateHolder`.', 'Check the code of your example in a Markdown file or in the editor below.');\n};\n\nvar Preview =\n/*#__PURE__*/\nfunction (_Component) {\n  _inheritsLoose(Preview, _Component);\n\n  function Preview() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _Component.call.apply(_Component, [this].concat(args)) || this;\n\n    _defineProperty(_assertThisInitialized(_this), \"mountNode\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      error: null\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleError\", function (err) {\n      _this.unmountPreview();\n\n      _this.setState({\n        error: improveErrorMessage(err.toString())\n      });\n\n      console.error(err); // eslint-disable-line no-console\n    });\n\n    return _this;\n  }\n\n  var _proto = Preview.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    // Clear console after hot reload, do not clear on the first load\n    // to keep any warnings\n    if (this.context.codeRevision > 0) {\n      // eslint-disable-next-line no-console\n      console.clear();\n    }\n\n    this.executeCode();\n  };\n\n  _proto.shouldComponentUpdate = function shouldComponentUpdate(nextProps, nextState) {\n    return this.state.error !== nextState.error || this.props.code !== nextProps.code;\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {\n    if (this.props.code !== prevProps.code) {\n      this.executeCode();\n    }\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    this.unmountPreview();\n  };\n\n  _proto.unmountPreview = function unmountPreview() {\n    if (this.mountNode) {\n      ReactDOM.unmountComponentAtNode(this.mountNode);\n    }\n  };\n\n  _proto.executeCode = function executeCode() {\n    var _this2 = this;\n\n    this.setState({\n      error: null\n    });\n    var code = this.props.code;\n\n    if (!code) {\n      return;\n    }\n\n    var wrappedComponent = React.createElement(ReactExample, {\n      code: code,\n      evalInContext: this.props.evalInContext,\n      onError: this.handleError,\n      compilerConfig: this.context.config.compilerConfig\n    });\n    window.requestAnimationFrame(function () {\n      // this.unmountPreview();\n      try {\n        ReactDOM.render(wrappedComponent, _this2.mountNode);\n      } catch (err) {\n        _this2.handleError(err);\n      }\n    });\n  };\n\n  _proto.render = function render() {\n    var _this3 = this;\n\n    var error = this.state.error;\n    return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      \"data-testid\": \"mountNode\",\n      ref: function ref(_ref) {\n        return _this3.mountNode = _ref;\n      }\n    }), error && React.createElement(PlaygroundError, {\n      message: error\n    }));\n  };\n\n  return Preview;\n}(Component);\n\n_defineProperty(Preview, \"propTypes\", {\n  code: PropTypes.string.isRequired,\n  evalInContext: PropTypes.func.isRequired\n});\n\n_defineProperty(Preview, \"contextType\", Context);\n\nexport { Preview as default };","map":{"version":3,"sources":["/Users/bmarshall/react-library/node_modules/react-styleguidist/lib/client/rsg-components/Preview/Preview.js"],"names":["_assertThisInitialized","self","ReferenceError","_inheritsLoose","subClass","superClass","prototype","Object","create","constructor","__proto__","_defineProperty","obj","key","value","defineProperty","enumerable","configurable","writable","React","Component","PropTypes","ReactDOM","PlaygroundError","ReactExample","Context","improveErrorMessage","message","replace","Preview","_Component","_this","_len","arguments","length","args","Array","_key","call","apply","concat","error","err","unmountPreview","setState","toString","console","_proto","componentDidMount","context","codeRevision","clear","executeCode","shouldComponentUpdate","nextProps","nextState","state","props","code","componentDidUpdate","prevProps","componentWillUnmount","mountNode","unmountComponentAtNode","_this2","wrappedComponent","createElement","evalInContext","onError","handleError","compilerConfig","config","window","requestAnimationFrame","render","_this3","Fragment","ref","_ref","string","isRequired","func","default"],"mappings":"AAGA,OAAO,mCAAP;;AAEA,SAASA,sBAAT,CAAgCC,IAAhC,EAAsC;AAAE,MAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAE,UAAM,IAAIC,cAAJ,CAAmB,2DAAnB,CAAN;AAAwF;;AAAC,SAAOD,IAAP;AAAc;;AAEtK,SAASE,cAAT,CAAwBC,QAAxB,EAAkCC,UAAlC,EAA8C;AAAED,EAAAA,QAAQ,CAACE,SAAT,GAAqBC,MAAM,CAACC,MAAP,CAAcH,UAAU,CAACC,SAAzB,CAArB;AAA0DF,EAAAA,QAAQ,CAACE,SAAT,CAAmBG,WAAnB,GAAiCL,QAAjC;AAA2CA,EAAAA,QAAQ,CAACM,SAAT,GAAqBL,UAArB;AAAkC;;AAEvL,SAASM,eAAT,CAAyBC,GAAzB,EAA8BC,GAA9B,EAAmCC,KAAnC,EAA0C;AAAE,MAAID,GAAG,IAAID,GAAX,EAAgB;AAAEL,IAAAA,MAAM,CAACQ,cAAP,CAAsBH,GAAtB,EAA2BC,GAA3B,EAAgC;AAAEC,MAAAA,KAAK,EAAEA,KAAT;AAAgBE,MAAAA,UAAU,EAAE,IAA5B;AAAkCC,MAAAA,YAAY,EAAE,IAAhD;AAAsDC,MAAAA,QAAQ,EAAE;AAAhE,KAAhC;AAA0G,GAA5H,MAAkI;AAAEN,IAAAA,GAAG,CAACC,GAAD,CAAH,GAAWC,KAAX;AAAmB;;AAAC,SAAOF,GAAP;AAAa;;AAEjN,OAAOO,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAOC,eAAP,MAA4B,gCAA5B;AACA,OAAOC,YAAP,MAAyB,6BAAzB;AACA,OAAOC,OAAP,MAAoB,wBAApB;;AAEA,IAAIC,mBAAmB,GAAG,SAASA,mBAAT,CAA6BC,OAA7B,EAAsC;AAC9D,SAAOA,OAAO,CAACC,OAAR,CAAgB,2CAAhB,EAA6D,2EAA7D,CAAP;AACD,CAFD;;AAIA,IAAIC,OAAO;AACX;AACA,UAAUC,UAAV,EAAsB;AACpB3B,EAAAA,cAAc,CAAC0B,OAAD,EAAUC,UAAV,CAAd;;AAEA,WAASD,OAAT,GAAmB;AACjB,QAAIE,KAAJ;;AAEA,SAAK,IAAIC,IAAI,GAAGC,SAAS,CAACC,MAArB,EAA6BC,IAAI,GAAG,IAAIC,KAAJ,CAAUJ,IAAV,CAApC,EAAqDK,IAAI,GAAG,CAAjE,EAAoEA,IAAI,GAAGL,IAA3E,EAAiFK,IAAI,EAArF,EAAyF;AACvFF,MAAAA,IAAI,CAACE,IAAD,CAAJ,GAAaJ,SAAS,CAACI,IAAD,CAAtB;AACD;;AAEDN,IAAAA,KAAK,GAAGD,UAAU,CAACQ,IAAX,CAAgBC,KAAhB,CAAsBT,UAAtB,EAAkC,CAAC,IAAD,EAAOU,MAAP,CAAcL,IAAd,CAAlC,KAA0D,IAAlE;;AAEAxB,IAAAA,eAAe,CAACX,sBAAsB,CAAC+B,KAAD,CAAvB,EAAgC,WAAhC,EAA6C,IAA7C,CAAf;;AAEApB,IAAAA,eAAe,CAACX,sBAAsB,CAAC+B,KAAD,CAAvB,EAAgC,OAAhC,EAAyC;AACtDU,MAAAA,KAAK,EAAE;AAD+C,KAAzC,CAAf;;AAIA9B,IAAAA,eAAe,CAACX,sBAAsB,CAAC+B,KAAD,CAAvB,EAAgC,aAAhC,EAA+C,UAAUW,GAAV,EAAe;AAC3EX,MAAAA,KAAK,CAACY,cAAN;;AAEAZ,MAAAA,KAAK,CAACa,QAAN,CAAe;AACbH,QAAAA,KAAK,EAAEf,mBAAmB,CAACgB,GAAG,CAACG,QAAJ,EAAD;AADb,OAAf;;AAIAC,MAAAA,OAAO,CAACL,KAAR,CAAcC,GAAd,EAP2E,CAOvD;AACrB,KARc,CAAf;;AAUA,WAAOX,KAAP;AACD;;AAED,MAAIgB,MAAM,GAAGlB,OAAO,CAACvB,SAArB;;AAEAyC,EAAAA,MAAM,CAACC,iBAAP,GAA2B,SAASA,iBAAT,GAA6B;AACtD;AACA;AACA,QAAI,KAAKC,OAAL,CAAaC,YAAb,GAA4B,CAAhC,EAAmC;AACjC;AACAJ,MAAAA,OAAO,CAACK,KAAR;AACD;;AAED,SAAKC,WAAL;AACD,GATD;;AAWAL,EAAAA,MAAM,CAACM,qBAAP,GAA+B,SAASA,qBAAT,CAA+BC,SAA/B,EAA0CC,SAA1C,EAAqD;AAClF,WAAO,KAAKC,KAAL,CAAWf,KAAX,KAAqBc,SAAS,CAACd,KAA/B,IAAwC,KAAKgB,KAAL,CAAWC,IAAX,KAAoBJ,SAAS,CAACI,IAA7E;AACD,GAFD;;AAIAX,EAAAA,MAAM,CAACY,kBAAP,GAA4B,SAASA,kBAAT,CAA4BC,SAA5B,EAAuC;AACjE,QAAI,KAAKH,KAAL,CAAWC,IAAX,KAAoBE,SAAS,CAACF,IAAlC,EAAwC;AACtC,WAAKN,WAAL;AACD;AACF,GAJD;;AAMAL,EAAAA,MAAM,CAACc,oBAAP,GAA8B,SAASA,oBAAT,GAAgC;AAC5D,SAAKlB,cAAL;AACD,GAFD;;AAIAI,EAAAA,MAAM,CAACJ,cAAP,GAAwB,SAASA,cAAT,GAA0B;AAChD,QAAI,KAAKmB,SAAT,EAAoB;AAClBxC,MAAAA,QAAQ,CAACyC,sBAAT,CAAgC,KAAKD,SAArC;AACD;AACF,GAJD;;AAMAf,EAAAA,MAAM,CAACK,WAAP,GAAqB,SAASA,WAAT,GAAuB;AAC1C,QAAIY,MAAM,GAAG,IAAb;;AAEA,SAAKpB,QAAL,CAAc;AACZH,MAAAA,KAAK,EAAE;AADK,KAAd;AAGA,QAAIiB,IAAI,GAAG,KAAKD,KAAL,CAAWC,IAAtB;;AAEA,QAAI,CAACA,IAAL,EAAW;AACT;AACD;;AAED,QAAIO,gBAAgB,GAAG9C,KAAK,CAAC+C,aAAN,CAAoB1C,YAApB,EAAkC;AACvDkC,MAAAA,IAAI,EAAEA,IADiD;AAEvDS,MAAAA,aAAa,EAAE,KAAKV,KAAL,CAAWU,aAF6B;AAGvDC,MAAAA,OAAO,EAAE,KAAKC,WAHyC;AAIvDC,MAAAA,cAAc,EAAE,KAAKrB,OAAL,CAAasB,MAAb,CAAoBD;AAJmB,KAAlC,CAAvB;AAMAE,IAAAA,MAAM,CAACC,qBAAP,CAA6B,YAAY;AACvC;AACA,UAAI;AACFnD,QAAAA,QAAQ,CAACoD,MAAT,CAAgBT,gBAAhB,EAAkCD,MAAM,CAACF,SAAzC;AACD,OAFD,CAEE,OAAOpB,GAAP,EAAY;AACZsB,QAAAA,MAAM,CAACK,WAAP,CAAmB3B,GAAnB;AACD;AACF,KAPD;AAQD,GA1BD;;AA4BAK,EAAAA,MAAM,CAAC2B,MAAP,GAAgB,SAASA,MAAT,GAAkB;AAChC,QAAIC,MAAM,GAAG,IAAb;;AAEA,QAAIlC,KAAK,GAAG,KAAKe,KAAL,CAAWf,KAAvB;AACA,WAAOtB,KAAK,CAAC+C,aAAN,CAAoB/C,KAAK,CAACyD,QAA1B,EAAoC,IAApC,EAA0CzD,KAAK,CAAC+C,aAAN,CAAoB,KAApB,EAA2B;AAC1E,qBAAe,WAD2D;AAE1EW,MAAAA,GAAG,EAAE,SAASA,GAAT,CAAaC,IAAb,EAAmB;AACtB,eAAOH,MAAM,CAACb,SAAP,GAAmBgB,IAA1B;AACD;AAJyE,KAA3B,CAA1C,EAKHrC,KAAK,IAAItB,KAAK,CAAC+C,aAAN,CAAoB3C,eAApB,EAAqC;AAChDI,MAAAA,OAAO,EAAEc;AADuC,KAArC,CALN,CAAP;AAQD,GAZD;;AAcA,SAAOZ,OAAP;AACD,CA3GD,CA2GET,SA3GF,CAFA;;AA+GAT,eAAe,CAACkB,OAAD,EAAU,WAAV,EAAuB;AACpC6B,EAAAA,IAAI,EAAErC,SAAS,CAAC0D,MAAV,CAAiBC,UADa;AAEpCb,EAAAA,aAAa,EAAE9C,SAAS,CAAC4D,IAAV,CAAeD;AAFM,CAAvB,CAAf;;AAKArE,eAAe,CAACkB,OAAD,EAAU,aAAV,EAAyBJ,OAAzB,CAAf;;AAEA,SAASI,OAAO,IAAIqD,OAApB","sourcesContent":["import \"core-js/modules/es.array.concat\";\nimport \"core-js/modules/es.object.to-string\";\nimport \"core-js/modules/es.regexp.to-string\";\nimport \"core-js/modules/es.string.replace\";\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport ReactDOM from 'react-dom';\nimport PlaygroundError from 'rsg-components/PlaygroundError';\nimport ReactExample from 'rsg-components/ReactExample';\nimport Context from 'rsg-components/Context';\n\nvar improveErrorMessage = function improveErrorMessage(message) {\n  return message.replace('Check the render method of `StateHolder`.', 'Check the code of your example in a Markdown file or in the editor below.');\n};\n\nvar Preview =\n/*#__PURE__*/\nfunction (_Component) {\n  _inheritsLoose(Preview, _Component);\n\n  function Preview() {\n    var _this;\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _Component.call.apply(_Component, [this].concat(args)) || this;\n\n    _defineProperty(_assertThisInitialized(_this), \"mountNode\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      error: null\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleError\", function (err) {\n      _this.unmountPreview();\n\n      _this.setState({\n        error: improveErrorMessage(err.toString())\n      });\n\n      console.error(err); // eslint-disable-line no-console\n    });\n\n    return _this;\n  }\n\n  var _proto = Preview.prototype;\n\n  _proto.componentDidMount = function componentDidMount() {\n    // Clear console after hot reload, do not clear on the first load\n    // to keep any warnings\n    if (this.context.codeRevision > 0) {\n      // eslint-disable-next-line no-console\n      console.clear();\n    }\n\n    this.executeCode();\n  };\n\n  _proto.shouldComponentUpdate = function shouldComponentUpdate(nextProps, nextState) {\n    return this.state.error !== nextState.error || this.props.code !== nextProps.code;\n  };\n\n  _proto.componentDidUpdate = function componentDidUpdate(prevProps) {\n    if (this.props.code !== prevProps.code) {\n      this.executeCode();\n    }\n  };\n\n  _proto.componentWillUnmount = function componentWillUnmount() {\n    this.unmountPreview();\n  };\n\n  _proto.unmountPreview = function unmountPreview() {\n    if (this.mountNode) {\n      ReactDOM.unmountComponentAtNode(this.mountNode);\n    }\n  };\n\n  _proto.executeCode = function executeCode() {\n    var _this2 = this;\n\n    this.setState({\n      error: null\n    });\n    var code = this.props.code;\n\n    if (!code) {\n      return;\n    }\n\n    var wrappedComponent = React.createElement(ReactExample, {\n      code: code,\n      evalInContext: this.props.evalInContext,\n      onError: this.handleError,\n      compilerConfig: this.context.config.compilerConfig\n    });\n    window.requestAnimationFrame(function () {\n      // this.unmountPreview();\n      try {\n        ReactDOM.render(wrappedComponent, _this2.mountNode);\n      } catch (err) {\n        _this2.handleError(err);\n      }\n    });\n  };\n\n  _proto.render = function render() {\n    var _this3 = this;\n\n    var error = this.state.error;\n    return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      \"data-testid\": \"mountNode\",\n      ref: function ref(_ref) {\n        return _this3.mountNode = _ref;\n      }\n    }), error && React.createElement(PlaygroundError, {\n      message: error\n    }));\n  };\n\n  return Preview;\n}(Component);\n\n_defineProperty(Preview, \"propTypes\", {\n  code: PropTypes.string.isRequired,\n  evalInContext: PropTypes.func.isRequired\n});\n\n_defineProperty(Preview, \"contextType\", Context);\n\nexport { Preview as default };"]},"metadata":{},"sourceType":"module"}